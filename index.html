<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LICORERIA AN</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        header, footer {
            background-color: #aca569;
            color: white;
            text-align: center;
            padding: 10px 0;
            width: 100%;
        }
        header img {
            max-width: 50px;
            vertical-align: middle;
        }
        header h1 {
            display: inline;
            margin-left: 10px;
        }
        footer {
            position: fixed;
            bottom: 0;
            width: 100%;
        }
        main {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 80%;
            max-width: 800px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        table, th, td {
            border: 1px solid black;
        }
        th, td {
            padding: 8px;
            text-align: left;
        }
        img {
            width: 50px;
        }
        form {
            display: flex;
            flex-direction: column;
            width: 50%;
        }
        form label, form input, form button {
            margin: 5px 0;
        }
        form button {
            align-self: center;
        }
    </style>
    <!-- Incluir Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.9.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.9.3/firebase-firestore-compat.js"></script>
    <script>
        // Configuración de Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyBtbwtEV54UibTbNI2rLS08xhiR0CquMC0",
            authDomain: "licoreria-c33d4.firebaseapp.com",
            projectId: "licoreria-c33d4",
            storageBucket: "licoreria-c33d4.appspot.com",
            messagingSenderId: "236261862007",
            appId: "1:236261862007:web:78f96318a93f483b92b472",
            measurementId: "G-BW9GSQNXW6"
        };
        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
    </script>
</head>
<body>
<header>
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcStoerRU2bpHDVdA7Xt-5AIrG7TR6-ohu_0yBuDuKslmQ&s" alt="Logo">
    <h1>BAR</h1>
</header>
<main>
    <h2>Registro</h2>

    <form id="productoForm">
        <label for="nombre">Nombre:</label>
        <input type="text" id="nombre" name="nombre" required>

        <label for="marca">Marca:</label>
        <input type="text" id="marca" name="marca" required>

        <label for="tipo">Tipo:</label>
        <input type="text" id="tipo" name="tipo" required>

        <label for="descripcion">Descripción:</label>
        <input type="text" id="descripcion" name="descripcion" required>

        <label for="volumen">Volumen:</label>
        <input type="number" id="volumen" name="volumen" required>

        <label for="grado">Grado de Alcohol:</label>
        <input type="number" id="grado" name="grado" required>

        <label for="stock">Stock:</label>
        <input type="number" id="stock" name="stock" required>

        <label for="categoria">Categoría:</label>
        <input type="text" id="categoria" name="categoria" required>

        <label for="valoracion">Valoración:</label>
        <input type="number" id="valoracion" name="valoracion" required>

        <label for="precio">Precio:</label>
        <input type="number" id="precio" name="precio" required>

        <button type="button" onclick="saveProducto()">Guardar</button>
    </form>
    <h2>EN LISTA</h2>
    <table id="productoTable">
        <thead>
            <tr>
                <th>Nombre</th>
                <th>Marca</th>
                <th>Tipo</th>
                <th>Descripción</th>
                <th>Volumen</th>
                <th>Grado de Alcohol</th>
                <th>Stock</th>
                <th>Categoría</th>
                <th>Valoración</th>
                <th>Precio</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody id="productoTableBody">
            <!-- Filas se añadirán dinámicamente -->
        </tbody>
    </table>
    <br><br>
</main>
<br><br>
<footer>
    <p>&copy; RESERVADO POR ABRAHAM NACIMBA</p>
</footer>
<script>
    let productos = [];
    let currentIndex = null;
    const dbCollection = db.collection("producto");

    async function saveProducto() {
        const productoForm = document.forms.productoForm;
        const newProducto = {
            nombre: productoForm.nombre.value,
            marca: productoForm.marca.value,
            tipo: productoForm.tipo.value,
            descripcion: productoForm.descripcion.value,
            volumen: parseFloat(productoForm.volumen.value),
            grado: parseFloat(productoForm.grado.value),
            stock: parseInt(productoForm.stock.value),
            categoria: productoForm.categoria.value,
            valoracion: parseFloat(productoForm.valoracion.value),
            precio: parseFloat(productoForm.precio.value),
        };

        if (currentIndex === null) {
            await dbCollection.add(newProducto);
        } else {
            const id = productos[currentIndex].id;
            await dbCollection.doc(id).update(newProducto);
        }

        loadProductos();
        productoForm.reset();
        currentIndex = null;
    }

    async function loadProductos() {
        const snapshot = await dbCollection.get();
        productos = snapshot.docs.map(doc => ({ ...doc.data(), id: doc.id }));
        renderTable();
    }

    function renderTable() {
        const tableBody = document.getElementById('productoTableBody');
        tableBody.innerHTML = '';

        productos.forEach((producto, index) => {
            const row = document.createElement('tr');

            row.innerHTML = `
                <td>${producto.nombre}</td>
                <td>${producto.marca}</td>
                <td>${producto.tipo}</td>
                <td>${producto.descripcion}</td>
                <td>${producto.volumen}</td>
                <td>${producto.grado}</td>
                <td>${producto.stock}</td>
                <td>${producto.categoria}</td>
                <td>${producto.valoracion}</td>
                <td>${producto.precio}</td>
                <td>
                    <button onclick="loadForm(${index})">Editar</button>
                    <button onclick="deleteProducto(${index})">Eliminar</button>
                </td>
            `;
            tableBody.appendChild(row);
        });
    }

    function loadForm(index) {
        const producto = productos[index];
        const productoForm = document.forms.productoForm;
        productoForm.nombre.value = producto.nombre;
        productoForm.marca.value = producto.marca;
        productoForm.tipo.value = producto.tipo;
        productoForm.descripcion.value = producto.descripcion;
        productoForm.volumen.value = producto.volumen;
        productoForm.grado.value = producto.grado;
        productoForm.stock.value = producto.stock;
        productoForm.categoria.value = producto.categoria;
        productoForm.valoracion.value = producto.valoracion;
        productoForm.precio.value = producto.precio;
        currentIndex = index;
    }

    async function deleteProducto(index) {
        const id = productos[index].id;
        await dbCollection.doc(id).delete();
        loadProductos();
        document.forms.productoForm.reset();
        currentIndex = null;
    }

    loadProductos();
</script>
</body>
</html>
